{% extends 'base.html' %}
{% load static %}

{% block title %}üîê Iniciar Sesi√≥n | Huella Urbana{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/login.css' %}">

{% endblock %}

{% block content %}

<div class="login-wrapper">
    <div class="login-container">

        <button class="back-btn" onclick="window.location.href='{% url 'index' %}'">
            <i class="fas fa-arrow-left"></i>
        </button>

        <div class="logo-container">
            <div class="logo-icon">
                <i class="fas fa-paw"></i>
            </div>
            <h1 class="logo-title">Huella Urbana</h1>
            <p class="logo-subtitle">Inicia sesi√≥n en tu cuenta</p>
        </div>

        <form method="POST" id="loginForm">
            {% csrf_token %}

            <div class="form-group">
                <label class="form-label" for="username">Correo o Usuario</label>
                <div class="input-group-custom">
                    <i class="fas fa-envelope input-icon"></i>
                    <input 
                        type="text" 
                        name="username" 
                        id="username" 
                        class="form-control-custom" 
                        placeholder="correo@ejemplo.com"
                        required
                    >
                </div>
                <div class="error-message" id="username-error"></div>
            </div>

            <div class="form-group">
                <label class="form-label" for="password">Contrase√±a</label>
                <div class="input-group-custom">
                    <i class="fas fa-lock input-icon"></i>
                    <input 
                        type="password" 
                        name="password" 
                        id="password" 
                        class="form-control-custom" 
                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                        required
                    >
                    <i class="fas fa-eye eye-icon" id="togglePassword"></i>
                </div>
                <div class="error-message" id="password-error"></div>
            </div>

            <div class="error-message" id="general-error"></div>

            <div class="remember-me">
                <input type="checkbox" id="remember" name="remember">
                <label for="remember">Recordar sesi√≥n</label>
            </div>

            <button type="submit" class="btn-login">
                <i class="fas fa-sign-in-alt"></i> 
                Iniciar Sesi√≥n
            </button>

            <div class="forgot-password">
                <a href="{% url 'password_reset' %}">¬øOlvidaste tu contrase√±a?</a>
            </div>
        </form>

        <div class="divider">
            <span>O continuar con</span>
        </div>

        <div class="social-buttons">
            <button class="social-btn" onclick="loginWithGoogle()">
                <i class="fab fa-google"></i> Google
            </button>
            <button class="social-btn" onclick="loginWithFacebook()">
                <i class="fab fa-facebook-f"></i> Facebook
            </button>
        </div>

        <div class="register-link">
            <p>¬øNo tienes cuenta? <a href="{% url 'registro' %}">Reg√≠strate</a></p>
        </div>

    </div>
</div>
<div id="django-errors" style="display:none;">
    {% if form.errors %}
        {% for field, errors in form.errors.items %}
            {% for error in errors %}
                <p class="django-error" data-field="{{ field }}">{{ error }}</p>
            {% endfor %}
        {% endfor %}
    {% endif %}

    {% if form.non_field_errors %}
        {% for error in form.non_field_errors %}
            <p class="django-error" data-field="__all__">{{ error }}</p>
        {% endfor %}
    {% endif %}
    
    {% if username_error %}
        <p id="username-context-error">{{ username_error }}</p>
    {% endif %}
    
    {% if password_error %}
        <p id="password-context-error">{{ password_error }}</p>
    {% endif %}
</div>
{% if messages %}
    <div id="django-messages" style="display:none;">
        {% for message in messages %}
            <p class="django-error" data-field="{{ message.tags }}">{{ message }}</p>
        {% endfor %}
    </div>
{% endif %}
{% endblock %}

{% block extra_scripts %}
    <script src="{% static 'js/login.js' %}"></script>

{% endblock %}